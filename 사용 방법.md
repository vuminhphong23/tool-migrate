# HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng - Directus Migration Tool

### 1. ğŸ”„ Import Dá»¯ Liá»‡u tá»« Directus

**CÃ¡ch sá»­ dá»¥ng:**

1. Má»Ÿ á»©ng dá»¥ng trong trÃ¬nh duyá»‡t
2. Nháº­p thÃ´ng tin **Source Directus** (instance nguá»“n):
   - API URL (vÃ­ dá»¥: `https://source.directus.app`)
   - Admin Token
3. Nháº­p thÃ´ng tin **Target Directus** (instance Ä‘Ã­ch):
   - API URL (vÃ­ dá»¥: `https://target.directus.app`)
   - Admin Token
4. Click **"Connect & Validate"** Ä‘á»ƒ kiá»ƒm tra káº¿t ná»‘i vÃ  phÃ¡t hiá»‡n collections
5. Chá»n collection muá»‘n import vÃ  click **"Import from another Directus"**
6. Theo dÃµi tiáº¿n trÃ¬nh import vÃ  xem káº¿t quáº£

**LÆ°u Ã½:**
- Token khÃ´ng cáº§n thÃªm prefix "Bearer " - tool sáº½ tá»± Ä‘á»™ng xá»­ lÃ½
- Giá»›i háº¡n sá»‘ lÆ°á»£ng items cÃ³ thá»ƒ Ä‘Æ°á»£c thiáº¿t láº­p trÆ°á»›c khi import

### 2. ğŸ“¦ Batch Migration (Di chuyá»ƒn hÃ ng loáº¡t)

Tá»± Ä‘á»™ng phÃ¢n tÃ­ch dependencies giá»¯a cÃ¡c collections vÃ  import theo thá»© tá»± tá»‘i Æ°u.

**CÃ¡ch sá»­ dá»¥ng:**
1. Sau khi káº¿t ná»‘i thÃ nh cÃ´ng vá»›i cáº£ 2 instances
2. Chá»n nhiá»u collections cáº§n migrate
3. Tool sáº½ tá»± Ä‘á»™ng:
   - PhÃ¢n tÃ­ch quan há»‡ phá»¥ thuá»™c giá»¯a cÃ¡c collections
   - Sáº¯p xáº¿p thá»© tá»± import há»£p lÃ½
   - Import tuáº§n tá»± trÃ¡nh lá»—i foreign key

### 3. ğŸ–¼ï¸ Import File & Media

Tá»± Ä‘á»™ng sao chÃ©p cÃ¡c file Ä‘Ã­nh kÃ¨m trong dá»¯ liá»‡u.

**TÃ­nh nÄƒng:**
- Há»— trá»£ single-file fields (UUID hoáº·c object vá»›i `id`)
- TÃ¡i sá»­ dá»¥ng file Ä‘Ã£ tá»“n táº¡i (dá»±a trÃªn checksum hoáº·c size/type)
- Tá»± Ä‘á»™ng táº¡o folder theo tÃªn collection
- Upload file má»›i khi cáº§n thiáº¿t
- Caching Ä‘á»ƒ trÃ¡nh upload trÃ¹ng láº·p

**Quyá»n cáº§n thiáº¿t:**
- Source: Ä‘á»c `/items/{collection}`, `/files/{id}`, `/assets/{id}`
- Target: táº¡o/cáº­p nháº­t `/items/{collection}`, `/files`, `/folders`

### 4. ğŸ” Quáº£n LÃ½ Access Control (Roles & Permissions)

Di chuyá»ƒn cáº¥u hÃ¬nh roles vÃ  permissions giá»¯a cÃ¡c instances.

**CÃ¡ch sá»­ dá»¥ng:**
1. VÃ o tab **Access Control**
2. Xem danh sÃ¡ch roles tá»« source instance
3. Chá»n roles muá»‘n migrate
4. Click **"Migrate Selected Roles"**
5. Tool sáº½:
   - Export roles vÃ  permissions
   - Import sang target instance
   - Ãnh xáº¡ láº¡i cÃ¡c field vÃ  collection IDs

### 5. âš™ï¸ Quáº£n LÃ½ Settings & Flows

**Settings Migration:**
- Di chuyá»ƒn cáº¥u hÃ¬nh project settings
- Bao gá»“m: branding, appearance, modules, security settings
- Tá»± Ä‘á»™ng xá»­ lÃ½ cÃ¡c giÃ¡ trá»‹ Ä‘áº·c thÃ¹ cho tá»«ng instance

**Flows Migration:**
- Import/export Directus Flows
- Há»— trá»£ triggers, operations
- Ãnh xáº¡ láº¡i collection vÃ  field references

### 6. âœ… Kiá»ƒm Tra & XÃ¡c Thá»±c

**Token Validation:**
- Click **"Validate Token"** Ä‘á»ƒ kiá»ƒm tra token há»£p lá»‡
- XÃ¡c minh quyá»n truy cáº­p trÆ°á»›c khi import

**Preflight Check:**
- Click **"Test Collections"** Ä‘á»ƒ kiá»ƒm tra permissions
- PhÃ¡t hiá»‡n sá»›m cÃ¡c váº¥n Ä‘á» vá» quyá»n truy cáº­p

### 7. ğŸ•˜ History Management

**LÆ°u láº¡i thÃ´ng tin káº¿t ná»‘i:**
- Domain vÃ  token Ä‘Æ°á»£c lÆ°u tá»± Ä‘á»™ng trong localStorage
- TÃ¡i sá»­ dá»¥ng nhanh chÃ³ng cho láº§n sau
- TÃ­nh nÄƒng **"Clear History"** Ä‘á»ƒ xÃ³a dá»¯ liá»‡u nháº¡y cáº£m

## Xá»­ LÃ½ Lá»—i ThÆ°á»ng Gáº·p

### Token validation tháº¥t báº¡i
- Kiá»ƒm tra token cÃ²n hiá»‡u lá»±c
- Äáº£m báº£o API URL Ä‘Ãºng vÃ  cÃ³ thá»ƒ truy cáº­p qua HTTPS

### 403 Forbidden khi import collection
- **Source**: Cáº¥p quyá»n READ cho role/token trÃªn collection Ä‘Ã³
- **Target**: Cáº¥p quyá»n CREATE/UPDATE vá»›i `id` tÆ°á»ng minh

### History khÃ´ng lÆ°u
- Kiá»ƒm tra quyá»n storage cá»§a trÃ¬nh duyá»‡t
- Thá»­ xÃ³a cache vÃ  táº£i láº¡i trang

## Báº£o Máº­t

- Admin token Ä‘Æ°á»£c lÆ°u local trong browser storage
- KhÃ´ng gá»­i dá»¯ liá»‡u Ä‘áº¿n third-party services
- Chá»‰ truy cáº­p collections vÃ  fields Ä‘Æ°á»£c chá»n
- NÃªn sá»­ dá»¥ng temporary admin tokens
- Clear history sau khi sá»­ dá»¥ng vá»›i dá»¯ liá»‡u nháº¡y cáº£m

## YÃªu Cáº§u Há»‡ Thá»‘ng

- **Node.js**: >= 16
- **Directus**: >= 11.0.0
- **Browser**: Chrome, Firefox, Safari, Edge (phiÃªn báº£n má»›i nháº¥t)

## Tips & Best Practices

1. **Thá»­ nghiá»‡m trÃªn mÃ´i trÆ°á»ng test trÆ°á»›c**: LuÃ´n test migration trÃªn instance test trÆ°á»›c khi cháº¡y production
2. **Backup dá»¯ liá»‡u**: Sao lÆ°u target instance trÆ°á»›c khi import
3. **Import theo batch nhá»**: Náº¿u cÃ³ nhiá»u dá»¯ liá»‡u, nÃªn import tá»«ng pháº§n vá»›i limit
4. **Kiá»ƒm tra dependencies**: Sá»­ dá»¥ng batch migration Ä‘á»ƒ tá»± Ä‘á»™ng xá»­ lÃ½ quan há»‡ phá»¥ thuá»™c
5. **Monitor logs**: Theo dÃµi console Ä‘á»ƒ xem chi tiáº¿t quÃ¡ trÃ¬nh import

## Há»— Trá»£

- Táº¡o issue trÃªn GitHub náº¿u gáº·p váº¥n Ä‘á»
- Xem pháº§n Troubleshooting trong README.md
- Kiá»ƒm tra CHANGELOG.md cho cÃ¡c updates má»›i nháº¥t

---

**License**: MIT  
**Version**: 1.1.0+  
**Compatible**: Directus 11.x - 15.x
